package lecture06;
/**
 *
 * @author Sanjeevi
 */
import java.sql.*;
public class Lecture06 {
    public static void main(String[] args) {
      
        try
        {
            Class.forName("com.microsoft.sqlserver.jdbc.SQLServerDriver");
            String url="jdbc:sqlserver://localhost:1433;databaseName=SampleDB";
            Connection con=DriverManager.getConnection(url,"sa","sql2014@@@");
            Statement st=con.createStatement();
            st.executeUpdate("insert into Customer values('123A','John')");
            
            PreparedStatement ps =con.prepareStatement("insert into Customer values (?,?)");
            
            ps.setString(1, "456B");
            ps.setString(2, "Ann");
            ps.executeUpdate();

            ps.setString(1, "555D");
            ps.setString(2, "Sam");
            ps.executeUpdate();
            
            
            PreparedStatement ps1 =con.prepareStatement("update customer set cname=? where cid = ?");
            ps1.setString(1, "Johny");
            ps1.setString(2, "123A");
            ps1.executeUpdate();
            
            PreparedStatement ps2 =con.prepareStatement("delete from customer where cid=?");
            ps2.setString(1, "555D");
            ps2.executeUpdate();
            
            
            CallableStatement cs=con.prepareCall("{?=call getCustomerName(?)}");
            cs.setString(2, "123A");
            cs.registerOutParameter(1, java.sql.Types.VARCHAR);
            cs.execute();
            
            String name=cs.getString(1);
            System.out.println(name);
            
            Statement st1=con.createStatement();
            ResultSet rs=st1.executeQuery("Select cname,cid from Customer");
            while(rs.next())
            {
                String name2=rs.getString("cname");
                String id=rs.getString(2);
                System.out.println(name2+"\t"+id);
            }
            con.close();
        }
        catch(Exception ex)
        {
            System.out.println(ex);
        }
    }
    
}